{"version":3,"file":"static/js/549.af8f2861.chunk.js","mappings":"yMAEO,MAAMA,EAAgBC,EAAAA,EAAOC,IAAGC,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,+QAiB1BC,EAAiBJ,EAAAA,EAAOC,IAAGI,IAAAA,GAAAF,EAAAA,EAAAA,GAAA,2LAW3BG,EAAUN,EAAAA,EAAOO,QAAOC,IAAAA,GAAAL,EAAAA,EAAAA,GAAA,wGAEjBM,GAASA,EAAMC,eAAa,SAInCC,EAAeX,EAAAA,EAAOY,GAAEC,IAAAA,GAAAV,EAAAA,EAAAA,GAAA,8NAexBW,EAAad,EAAAA,EAAOe,OAAMC,IAAAA,GAAAb,EAAAA,EAAAA,GAAA,qkBACnCM,GACAA,EAAMQ,UAAQ,8DAMNR,GAASA,EAAMS,QAAM,WAItBT,GAAUA,EAAMU,MAAQV,EAAMU,MAAQ,uBAuBpCC,EAAiBpB,EAAAA,EAAOqB,EAACC,IAAAA,GAAAnB,EAAAA,EAAAA,GAAA,8oB,qGCtF/B,MAAMoB,EAAeC,GAASA,EAAMC,QAAQC,MAEtCC,EAAkBH,GAASA,EAAMC,QAAQG,UAEzCC,EAAiBL,GAASA,EAAMC,QAAQK,SAExCC,EAAkBP,GAASA,EAAMC,QAAQO,U,qECH/C,MAAMC,EAAiBjC,EAAAA,EAAOC,IAAGC,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,uGAO3B+B,EAAelC,EAAAA,EAAOC,IAAGI,IAAAA,GAAAF,EAAAA,EAAAA,GAAA,+FAOzBgC,EAAanC,EAAAA,EAAOC,IAAGO,IAAAA,GAAAL,EAAAA,EAAAA,GAAA,4JAQvBiC,EAAgBpC,EAAAA,EAAOC,IAAGY,IAAAA,GAAAV,EAAAA,EAAAA,GAAA,gJAU1BkC,EAAQrC,EAAAA,EAAOY,GAAEI,IAAAA,GAAAb,EAAAA,EAAAA,GAAA,6EAMjBmC,EAAQtC,EAAAA,EAAOuC,MAAKjB,IAAAA,GAAAnB,EAAAA,EAAAA,GAAA,6IAQpBqC,EAAYxC,EAAAA,EAAOyC,MAAKC,IAAAA,GAAAvC,EAAAA,EAAAA,GAAA,uFAMxBwC,EAAW3C,EAAAA,EAAO4C,GAAEC,IAAAA,GAAA1C,EAAAA,EAAAA,GAAA,iFAMpB2C,EAAc9C,EAAAA,EAAO+C,GAAEC,IAAAA,GAAA7C,EAAAA,EAAAA,GAAA,4BAIvB8C,EAAYjD,EAAAA,EAAOkD,GAAEC,IAAAA,GAAAhD,EAAAA,EAAAA,GAAA,4BAIrBiD,EAAoBpD,EAAAA,EAAOkD,GAAEG,IAAAA,GAAAlD,EAAAA,EAAAA,GAAA,4HAW7BmD,EAActD,EAAAA,EAAOe,OAAMwC,IAAAA,GAAApD,EAAAA,EAAAA,GAAA,sQAgB3BqD,GAAexD,EAAAA,EAAAA,GAAOyD,EAAAA,IAAPzD,CAAkB0D,IAAAA,GAAAvD,EAAAA,EAAAA,GAAA,4E,aCrEvC,MAAMwD,EAAiBA,KAC5B,MAAMC,GAASC,EAAAA,EAAAA,IAAYtC,GACrBK,GAAYiC,EAAAA,EAAAA,IAAYlC,GACxBG,GAAW+B,EAAAA,EAAAA,IAAYhC,GAiE7B,OACEiC,EAAAA,EAAAA,MAAC7B,EAAc,CAAA8B,SAAA,CACZH,GAAUA,EAAOI,OAAS,IACzBF,EAAAA,EAAAA,MAAAG,EAAAA,SAAA,CAAAF,SAAA,EACEG,EAAAA,EAAAA,KAACZ,EAAW,CAACa,KAAK,SAASC,QAnENC,UAC3B,MAAMC,EAAW,IAAIC,IAAAA,UACfC,EAAkBF,EAASG,aAAa,iHACxCC,EAA6BJ,EAASG,aAC1C,iHAEIE,EAAoBL,EAASG,aAAa,0FAEhDD,EAAgBI,OAAO,CACrB,0DACA,kCACA,8FACA,6CACA,uEACA,4EACA,iFACA,2DAGFhB,EAAOiB,SAAQC,IACbN,EAAgBI,OAAO,EACrBG,EAAAA,EAAAA,GAAaD,EAAME,WACnBF,EAAMG,cACNH,EAAMI,YACNJ,EAAMK,SAASC,KAAIC,GAAWA,EAAQC,OAAMC,KAAK,MACjDT,EAAMU,oBACNV,EAAMW,QACNX,EAAMY,cACNZ,EAAMa,QACN,IAGJjB,EAA2BE,OAAO,CAAC,sBAAQ,uBAE3ChD,EAAUiD,SAAQe,IAChBlB,EAA2BE,OAAO,CAACgB,EAASN,KAAMM,EAASH,SAAS,IAGtEd,EAAkBC,OAAO,CAAC,yDAAa,iDAEvCD,EAAkBC,OAAO,CAAC,iEAAgB9C,EAAS+D,gBACnDlB,EAAkBC,OAAO,CAAC,yFAAoB9C,EAASgE,YACvDnB,EAAkBC,OAAO,CAAC,qGAAsB9C,EAASiE,YACzDpB,EAAkBC,OAAO,CACvB,8HACA9C,EAASkE,yBAEXrB,EAAkBC,OAAO,CAAC,kCAAU9C,EAASmE,SAE7C,MAAMC,QAAe5B,EAAS6B,KAAKC,cAC7BC,EAAO,IAAIC,KAAK,CAACJ,GAAS,CAC9B/B,KAAM,sEAEFoC,EAAMC,IAAIC,gBAAgBJ,GAE1BhF,EAAIqF,SAASC,cAAc,KACjCtF,EAAEuF,KAAOL,EACTlF,EAAEwF,SAAW,cACbxF,EAAEyF,QAEFN,IAAIO,gBAAgBR,EAAI,EAOuCxC,UACvDG,EAAAA,EAAAA,KAACV,EAAY,OAEfU,EAAAA,EAAAA,KAAC7B,EAAK,CAAA0B,SAAC,yJACPG,EAAAA,EAAAA,KAAChC,EAAY,CAAA6B,UACXD,EAAAA,EAAAA,MAACxB,EAAK,CAAAyB,SAAA,EACJG,EAAAA,EAAAA,KAAC1B,EAAS,CAAAuB,UACRD,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,6DACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,qCACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,iGACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,gDACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,0EACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,+EACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,oFACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,iEAGjBG,EAAAA,EAAAA,KAAA,SAAAH,SACGH,EAAOwB,KAAIN,IACVhB,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,UAAEgB,EAAAA,EAAAA,GAAaD,EAAME,cAC/Bd,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEe,EAAMG,iBAClBf,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEe,EAAMI,eAClBhB,EAAAA,EAAAA,KAACd,EAAiB,CAAAW,SACfe,EAAMK,SAASC,KAAIC,IAClBnB,EAAAA,EAAAA,KAAA,KAAAH,SAAsBsB,EAAQC,MAAtBD,EAAQ2B,UAGpB9C,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEe,EAAMU,uBAClBtB,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEe,EAAMW,WAClBvB,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEe,EAAMY,iBAClBxB,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEe,EAAMa,WAZLb,EAAMkC,kBAoBjClD,EAAAA,EAAAA,MAAC1B,EAAa,CAAA2B,SAAA,CACXnC,GAAaA,EAAUoC,OAAS,IAC/BF,EAAAA,EAAAA,MAAC3B,EAAU,CAAA4B,SAAA,EACTG,EAAAA,EAAAA,KAAC7B,EAAK,CAAA0B,SAAC,2FACPD,EAAAA,EAAAA,MAACxB,EAAK,CAAAyB,SAAA,EACJG,EAAAA,EAAAA,KAAC1B,EAAS,CAAAuB,UACRD,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,yBACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,6BAGjBG,EAAAA,EAAAA,KAAA,SAAAH,SACGnC,EAAUwD,KAAIQ,IACb9B,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAE6B,EAASN,QACrBpB,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAE6B,EAASH,YAFRG,EAASN,gBASjCxD,IACCgC,EAAAA,EAAAA,MAAC3B,EAAU,CAAA4B,SAAA,EACTG,EAAAA,EAAAA,KAAC7B,EAAK,CAAA0B,SAAC,kEACPD,EAAAA,EAAAA,MAACxB,EAAK,CAAAyB,SAAA,EACJG,EAAAA,EAAAA,KAAC1B,EAAS,CAAAuB,UACRD,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,4DACbG,EAAAA,EAAAA,KAACpB,EAAW,CAAAiB,SAAC,6BAGjBD,EAAAA,EAAAA,MAAA,SAAAC,SAAA,EACED,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAC,oEACXG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEjC,EAAS+D,oBAEvB/B,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAC,4FACXG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEjC,EAASgE,gBAEvBhC,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAC,wGACXG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEjC,EAASiE,gBAEvBjC,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAC,iIACXG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEjC,EAASkE,6BAEvBlC,EAAAA,EAAAA,MAACnB,EAAQ,CAAAoB,SAAA,EACPG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAC,qCACXG,EAAAA,EAAAA,KAACjB,EAAS,CAAAc,SAAEjC,EAASmE,0BAOlB,E,wCClMd,MAAMgB,EAAajH,EAAAA,EAAOkH,KAAIhH,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,4UAiBxBgH,EAAYnH,EAAAA,EAAOoH,MAAK/G,IAAAA,GAAAF,EAAAA,EAAAA,GAAA,QAExBkH,GAAQrH,EAAAA,EAAAA,GAAOsH,EAAAA,EAAPtH,CAAiBQ,IAAAA,GAAAL,EAAAA,EAAAA,GAAA,0BCfzBoH,EAAmBA,KAC9B,MAAMC,GAAWC,EAAAA,EAAAA,MACXC,GAASC,EAAAA,EAAAA,IAAU,CACvBC,cAAe,CACbC,UAAW,GACXC,QAAS,IAEXC,SAAUC,IACRR,GAASS,EAAAA,EAAAA,GAAoBD,GAAQ,IAGzC,OACElE,EAAAA,EAAAA,MAACmD,EAAU,CAACc,SAAUL,EAAOQ,aAAanE,SAAA,EACxCD,EAAAA,EAAAA,MAACqD,EAAS,CAAApD,SAAA,CAAC,8CAETG,EAAAA,EAAAA,KAACmD,EAAK,CACJc,UAAQ,EACRhE,KAAK,OACLiE,GAAG,YACH9C,KAAK,YACL+C,MAAOX,EAAOM,OAAOH,UACrBS,SAAUZ,EAAOa,aACjBC,QAAQ,WACRC,UAAU,cAGd3E,EAAAA,EAAAA,MAACqD,EAAS,CAAApD,SAAA,CAAC,wCAETG,EAAAA,EAAAA,KAACmD,EAAK,CACJc,UAAQ,EACRhE,KAAK,OACLiE,GAAG,UACH9C,KAAK,UACL+C,MAAOX,EAAOM,OAAOF,QACrBQ,SAAUZ,EAAOa,aACjBC,QAAQ,WACRC,UAAU,cAGdvE,EAAAA,EAAAA,KAACpD,EAAAA,GAAU,CAACqD,KAAK,SAAShD,MAAM,qBAAoB4C,SAAC,qCAG1C,EC5BjB,GAZsB2E,KACpB,MAAM1G,GAAY6B,EAAAA,EAAAA,IAAY9B,GAE9B,OACE+B,EAAAA,EAAAA,MAACxD,EAAAA,GAAO,CAACI,eAAe,EAAKqD,SAAA,EAC3BG,EAAAA,EAAAA,KAACqD,EAAgB,KACjBrD,EAAAA,EAAAA,KAACP,EAAc,IACd3B,IAAakC,EAAAA,EAAAA,KAACyE,EAAAA,EAAO,MACd,C,iBCjBP,SAAS5D,EAAa6D,GAC3B,MAAMC,EAAW,IAAIC,KAAKF,GAEpBG,EAAOF,EAASG,mBAAmB,QAAS,CAChDC,IAAK,UACLC,MAAO,UACPC,KAAM,YAGFC,EAAOP,EAASQ,mBAAmB,QAAS,CAChDC,KAAM,UACNC,OAAQ,YAGV,MAAM,GAANC,OAAUT,EAAI,KAAAS,OAAIJ,EACpB,C","sources":["components/Global/Global.styled.jsx","redux/reporting/reportingSelectors.js","components/AdminPage/ReportPage/ReportTable/ReportTable.styled.jsx","components/AdminPage/ReportPage/ReportTable/ReportTable.jsx","components/AdminPage/ReportPage/ReportSearchForm/ReportSearchForm.styled.jsx","components/AdminPage/ReportPage/ReportSearchForm/ReportSearchForm.jsx","pages/Report/Report.jsx","utils/formatedDate.js"],"sourcesContent":["import styled from '@emotion/styled';\n\nexport const MainContainer = styled.div`\n  margin-left: auto;\n  margin-right: auto;\n  padding-left: 15px;\n  padding-right: 15px;\n\n  max-width: 480px;\n\n  @media screen and (min-width: 768px) {\n    max-width: 768px;\n  }\n\n  @media screen and (min-width: 1200px) {\n    max-width: 1200px;\n  }\n`;\n\nexport const AdminContainer = styled.div`\n  width: 100%;\n  max-width: 1600px;\n  @media screen and (min-width: 768px) {\n    padding: 0 30px;\n  }\n  @media screen and (min-width: 1200px) {\n    padding: 0 80px;\n  }\n`;\n\nexport const Section = styled.section`\n  padding-top: 80px;\n  padding-bottom: ${props => props.paddingBottom && `80px`};\n  animation: fadeIn 0.5s ease-in-out forwards;\n`;\n\nexport const SectionTitle = styled.h2`\n  text-align: center;\n  margin-bottom: 30px;\n\n  font-weight: 700;\n  font-size: 28px;\n  line-height: 1.17;\n\n  @media screen and (min-width: 1200px) {\n    margin-bottom: 50px;\n\n    font-size: 36px;\n  }\n`;\n\nexport const MainButton = styled.button`\n  ${props =>\n    props.position &&\n    `position: absolute;\n    top: 20px;\n    right: 20px;\n  `};\n\n  margin: ${props => props.margin && `0 auto`};\n  height: 50px;\n  min-width: 200px;\n\n  color: ${props => (props.color ? props.color : 'var(--white-color)')};\n  background-color: transparent;\n  box-shadow: 0px 0px 20px var(--accent-color);\n\n  font-weight: 400;\n  font-size: 13px;\n  letter-spacing: 0.07em;\n\n  border-radius: 25px;\n  border: 1px solid var(--accent-color);\n  cursor: pointer;\n  transition: background-color var(--transition), color var(--transition);\n\n  &:hover,\n  &:focus {\n    background-color: var(--accent-color);\n    color: var(--black-color);\n  }\n\n  opacity: 0;\n  animation: fadeIn 0.5s ease-in-out forwards;\n`;\n\nexport const MainLinkButton = styled.a`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  min-height: 50px;\n  min-width: 200px;\n\n  box-shadow: 0px 0px 20px var(--accent-color);\n\n  font-weight: 400;\n  font-size: 13px;\n  letter-spacing: 0.07em;\n\n  @media screen and (min-width: 1200px) {\n    font-size: 12px;\n  }\n\n  color: var(--white-color);\n  background-color: transparent;\n\n  border-radius: 25px;\n  border: 1px solid var(--accent-color);\n  cursor: pointer;\n  transition: background-color var(--transition), color var(--transition);\n\n  &:hover,\n  &:focus {\n    background-color: var(--accent-color);\n    color: var(--black-color);\n  }\n`;\n","export const selectOrders = state => state.reports.items;\n\nexport const selectEmployees = state => state.reports.employees;\n\nexport const selectPayments = state => state.reports.payments;\n\nexport const selectIsLoading = state => state.reports.isLoading;\n\nexport const selectError = state => state.reports.error;\n","import styled from '@emotion/styled';\nimport { FiDownload } from 'react-icons/fi';\n\nexport const TableContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  max-width: 100%;\n`;\n\nexport const TableWrapper = styled.div`\n  max-width: 100%;\n  overflow-x: auto;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nexport const TableThumb = styled.div`\n  flex-basis: calc(50% - 10px);\n  margin-top: 20px;\n  border-bottom-left-radius: 8px;\n  border-bottom-right-radius: 8px;\n  overflow: hidden;\n`;\n\nexport const FlexContainer = styled.div`\n  display: flex;\n  gap: 20px;\n  flex-direction: column;\n\n  @media screen and (min-width: 768px) {\n    flex-direction: row;\n  }\n`;\n\nexport const Title = styled.h2`\n  margin-bottom: 20px;\n  text-align: center;\n  font-size: 20px;\n`;\n\nexport const Table = styled.table`\n  width: 100%;\n  border-collapse: collapse;\n  border-spacing: 0;\n  background-color: var(--table-background);\n  color: black;\n`;\n\nexport const TableHead = styled.thead`\n  background-color: var(--table-head);\n  color: #fff;\n  text-align: left;\n`;\n\nexport const TableRow = styled.tr`\n  &:nth-of-type(even) {\n    background-color: var(--table-row);\n  }\n`;\n\nexport const TableHeader = styled.th`\n  padding: 10px;\n`;\n\nexport const TableData = styled.td`\n  padding: 10px;\n`;\n\nexport const TableCellServices = styled.td`\n  padding: 10px;\n  display: flex;\n  flex-direction: column;\n\n  p {\n    margin: 0;\n    padding: 5px 0;\n  }\n`;\n\nexport const DownloadBtn = styled.button`\n  margin-left: auto;\n  width: 50px;\n  height: 50px;\n  background-color: var(--white-color);\n  border: none;\n  border-radius: 50%;\n  cursor: pointer;\n  opacity: 0.5;\n\n  transition: opacity var(--transition);\n  &:hover {\n    opacity: 1;\n  }\n`;\n\nexport const DownloadIcon = styled(FiDownload)`\n  width: 30px;\n  height: 30px;\n  color: var(--download-color);\n`;\n","import ExcelJS from 'exceljs';\nimport { useSelector } from 'react-redux';\n\nimport {\n  selectOrders,\n  selectEmployees,\n  selectPayments,\n} from 'redux/reporting/reportingSelectors';\n\nimport { formatedDate } from 'utils/formatedDate';\n\nimport {\n  TableContainer,\n  TableWrapper,\n  TableThumb,\n  FlexContainer,\n  Title,\n  Table,\n  TableHead,\n  TableRow,\n  TableHeader,\n  TableData,\n  TableCellServices,\n  DownloadBtn,\n  DownloadIcon,\n} from './ReportTable.styled';\n\nexport const ReportingTable = () => {\n  const orders = useSelector(selectOrders);\n  const employees = useSelector(selectEmployees);\n  const payments = useSelector(selectPayments);\n\n  const handleDownloadReport = async () => {\n    const workbook = new ExcelJS.Workbook();\n    const worksheetOrders = workbook.addWorksheet('Виконані замовлення');\n    const worksheetEmployeesPayments = workbook.addWorksheet(\n      'Виплата працівникам'\n    );\n    const worksheetPayments = workbook.addWorksheet('Дані про платежі');\n\n    worksheetOrders.addRow([\n      'Час заїзду',\n      \"Об'єкт\",\n      'Контакти клієнта',\n      'Послуги',\n      'Вартість, грн',\n      'Спосіб оплати',\n      'Адміністратор',\n      'Працівник',\n    ]);\n\n    orders.forEach(order => {\n      worksheetOrders.addRow([\n        formatedDate(order.orderDate),\n        order.serviceObject,\n        order.clientPhone,\n        order.services.map(service => service.name).join(', '),\n        order.discountedCostOrder,\n        order.payment,\n        order.administrator,\n        order.washer,\n      ]);\n    });\n\n    worksheetEmployeesPayments.addRow(['Ім`я', 'грн']);\n\n    employees.forEach(employee => {\n      worksheetEmployeesPayments.addRow([employee.name, employee.payment]);\n    });\n\n    worksheetPayments.addRow(['Категорія', 'Сума, грн']);\n\n    worksheetPayments.addRow(['Всього каса:', payments.totalPayments]);\n    worksheetPayments.addRow(['Всього готівкою:', payments.totalCash]);\n    worksheetPayments.addRow(['Всього терміналом:', payments.totalCard]);\n    worksheetPayments.addRow([\n      'Всього заробітна плата:',\n      payments.totalEmployeesPayments,\n    ]);\n    worksheetPayments.addRow(['Дохід:', payments.profit]);\n\n    const buffer = await workbook.xlsx.writeBuffer();\n    const blob = new Blob([buffer], {\n      type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n    });\n    const url = URL.createObjectURL(blob);\n\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'report.xlsx';\n    a.click();\n\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <TableContainer>\n      {orders && orders.length > 0 && (\n        <>\n          <DownloadBtn type=\"button\" onClick={handleDownloadReport}>\n            <DownloadIcon />\n          </DownloadBtn>\n          <Title>Звітність за обраний період</Title>\n          <TableWrapper>\n            <Table>\n              <TableHead>\n                <TableRow>\n                  <TableHeader>Час заїзду</TableHeader>\n                  <TableHeader>Об'єкт</TableHeader>\n                  <TableHeader>Контакти клієнта</TableHeader>\n                  <TableHeader>Послуги</TableHeader>\n                  <TableHeader>Вартість, грн</TableHeader>\n                  <TableHeader>Спосіб оплати</TableHeader>\n                  <TableHeader>Адміністратор</TableHeader>\n                  <TableHeader>Працівник</TableHeader>\n                </TableRow>\n              </TableHead>\n              <tbody>\n                {orders.map(order => (\n                  <TableRow key={order._id}>\n                    <TableData>{formatedDate(order.orderDate)}</TableData>\n                    <TableData>{order.serviceObject}</TableData>\n                    <TableData>{order.clientPhone}</TableData>\n                    <TableCellServices>\n                      {order.services.map(service => (\n                        <p key={service._id}>{service.name}</p>\n                      ))}\n                    </TableCellServices>\n                    <TableData>{order.discountedCostOrder}</TableData>\n                    <TableData>{order.payment}</TableData>\n                    <TableData>{order.administrator}</TableData>\n                    <TableData>{order.washer}</TableData>\n                  </TableRow>\n                ))}\n              </tbody>\n            </Table>\n          </TableWrapper>\n        </>\n      )}\n      <FlexContainer>\n        {employees && employees.length > 0 && (\n          <TableThumb>\n            <Title>Заробітна плата</Title>\n            <Table>\n              <TableHead>\n                <TableRow>\n                  <TableHeader>Ім'я</TableHeader>\n                  <TableHeader>грн</TableHeader>\n                </TableRow>\n              </TableHead>\n              <tbody>\n                {employees.map(employee => (\n                  <TableRow key={employee.name}>\n                    <TableData>{employee.name}</TableData>\n                    <TableData>{employee.payment}</TableData>\n                  </TableRow>\n                ))}\n              </tbody>\n            </Table>\n          </TableThumb>\n        )}\n        {payments && (\n          <TableThumb>\n            <Title>Розрахунок</Title>\n            <Table>\n              <TableHead>\n                <TableRow>\n                  <TableHeader>Категорія</TableHeader>\n                  <TableHeader>грн</TableHeader>\n                </TableRow>\n              </TableHead>\n              <tbody>\n                <TableRow>\n                  <TableData>Всього каса:</TableData>\n                  <TableData>{payments.totalPayments}</TableData>\n                </TableRow>\n                <TableRow>\n                  <TableData>Всього готівкою:</TableData>\n                  <TableData>{payments.totalCash}</TableData>\n                </TableRow>\n                <TableRow>\n                  <TableData>Всього терміналом:</TableData>\n                  <TableData>{payments.totalCard}</TableData>\n                </TableRow>\n                <TableRow>\n                  <TableData>Всього заробітна плата:</TableData>\n                  <TableData>{payments.totalEmployeesPayments}</TableData>\n                </TableRow>\n                <TableRow>\n                  <TableData>Дохід:</TableData>\n                  <TableData>{payments.profit}</TableData>\n                </TableRow>\n              </tbody>\n            </Table>\n          </TableThumb>\n        )}\n      </FlexContainer>\n    </TableContainer>\n  );\n};\n","import styled from '@emotion/styled';\nimport { TextField } from '@mui/material';\n\nexport const SearchForm = styled.form`\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  justify-content: center;\n  gap: 30px;\n  padding: 25px;\n  margin-bottom: 40px;\n  color: var(--black-color);\n  background-color: var(--white-color);\n  border-radius: 12px;\n\n  @media screen and (min-width: 768px) {\n    flex-direction: row;\n  }\n`;\n\nexport const DateLabel = styled.label``;\n\nexport const Input = styled(TextField)`\n  width: 100%;\n`;\n","import { useFormik } from 'formik';\nimport { useDispatch } from 'react-redux';\nimport { getReportingByDates } from 'redux/reporting/reportingOperations';\n\nimport { MainButton } from 'components/Global/Global.styled';\nimport { SearchForm, DateLabel, Input } from './ReportSearchForm.styled';\n\nexport const ReportSearchForm = () => {\n  const dispatch = useDispatch();\n  const formik = useFormik({\n    initialValues: {\n      startDate: '',\n      endDate: '',\n    },\n    onSubmit: values => {\n      dispatch(getReportingByDates(values));\n    },\n  });\n  return (\n    <SearchForm onSubmit={formik.handleSubmit}>\n      <DateLabel>\n        Початок\n        <Input\n          required\n          type=\"date\"\n          id=\"startDate\"\n          name=\"startDate\"\n          value={formik.values.startDate}\n          onChange={formik.handleChange}\n          variant=\"standard\"\n          className=\"field\"\n        />\n      </DateLabel>\n      <DateLabel>\n        Кінець\n        <Input\n          required\n          type=\"date\"\n          id=\"endDate\"\n          name=\"endDate\"\n          value={formik.values.endDate}\n          onChange={formik.handleChange}\n          variant=\"standard\"\n          className=\"field\"\n        />\n      </DateLabel>\n      <MainButton type=\"submit\" color=\"var(--black-color)\">\n        Пошук\n      </MainButton>\n    </SearchForm>\n  );\n};\n","import { useSelector } from 'react-redux';\n\nimport { Section } from 'components/Global/Global.styled';\nimport { Loading } from 'components/Loading/Loading';\nimport { ReportingTable } from 'components/AdminPage/ReportPage/ReportTable/ReportTable';\nimport { ReportSearchForm } from 'components/AdminPage/ReportPage/ReportSearchForm/ReportSearchForm';\n\nimport { selectIsLoading } from 'redux/reporting/reportingSelectors';\n\nconst ReportingPage = () => {\n  const isLoading = useSelector(selectIsLoading);\n\n  return (\n    <Section paddingBottom={true}>\n      <ReportSearchForm />\n      <ReportingTable />\n      {isLoading && <Loading />}\n    </Section>\n  );\n};\n\nexport default ReportingPage;\n","export function formatedDate(unformatedDate) {\n  const dateTime = new Date(unformatedDate);\n\n  const date = dateTime.toLocaleDateString('uk-UA', {\n    day: '2-digit',\n    month: '2-digit',\n    year: 'numeric',\n  });\n\n  const time = dateTime.toLocaleTimeString('uk-UA', {\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n\n  return `${date} ${time}`;\n}\n"],"names":["MainContainer","styled","div","_templateObject","_taggedTemplateLiteral","AdminContainer","_templateObject2","Section","section","_templateObject3","props","paddingBottom","SectionTitle","h2","_templateObject4","MainButton","button","_templateObject5","position","margin","color","MainLinkButton","a","_templateObject6","selectOrders","state","reports","items","selectEmployees","employees","selectPayments","payments","selectIsLoading","isLoading","TableContainer","TableWrapper","TableThumb","FlexContainer","Title","Table","table","TableHead","thead","_templateObject7","TableRow","tr","_templateObject8","TableHeader","th","_templateObject9","TableData","td","_templateObject10","TableCellServices","_templateObject11","DownloadBtn","_templateObject12","DownloadIcon","FiDownload","_templateObject13","ReportingTable","orders","useSelector","_jsxs","children","length","_Fragment","_jsx","type","onClick","async","workbook","ExcelJS","worksheetOrders","addWorksheet","worksheetEmployeesPayments","worksheetPayments","addRow","forEach","order","formatedDate","orderDate","serviceObject","clientPhone","services","map","service","name","join","discountedCostOrder","payment","administrator","washer","employee","totalPayments","totalCash","totalCard","totalEmployeesPayments","profit","buffer","xlsx","writeBuffer","blob","Blob","url","URL","createObjectURL","document","createElement","href","download","click","revokeObjectURL","_id","SearchForm","form","DateLabel","label","Input","TextField","ReportSearchForm","dispatch","useDispatch","formik","useFormik","initialValues","startDate","endDate","onSubmit","values","getReportingByDates","handleSubmit","required","id","value","onChange","handleChange","variant","className","ReportingPage","Loading","unformatedDate","dateTime","Date","date","toLocaleDateString","day","month","year","time","toLocaleTimeString","hour","minute","concat"],"sourceRoot":""}